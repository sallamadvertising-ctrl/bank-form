
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Bank Beneficiary App</title>

<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Security-Policy"
content="default-src * 'unsafe-inline' 'unsafe-eval' data: blob:;">

<style>
body{
    font-family: Arial, sans-serif;
    background:#f2f2f2;
    padding:15px;
}

h2{
    text-align:center;
}

input,select,button{
    width:100%;
    padding:10px;
    margin:6px 0;
    border-radius:5px;
    border:1px solid #ccc;
}

button{
    background:#007bff;
    color:white;
    border:none;
    font-size:16px;
}

button:hover{
    background:#0056b3;
}

#status{
    text-align:center;
    margin-top:10px;
    color:green;
}
</style>
</head>

<body>

<h2>Beneficiary Form</h2>

<label>Beneficiary Name</label>
<input type="text" id="name">

<label>IBAN</label>
<input type="text" id="iban" onblur="checkIBAN()">

<label>SWIFT Code</label>
<input type="text" id="swift" onblur="checkSWIFT()">

<label>Bank Name</label>
<input type="text" id="bank" readonly>

<label>City</label>
<input type="text" id="city" readonly>

<label>Country</label>
<input type="text" id="country" readonly>

<label>Address</label>
<input type="text" id="address">

<button onclick="saveData()">Save</button>

<div id="status"></div>


<script>

function cleanText(id){
    let v=document.getElementById(id).value;

    v=v.replace(/[^A-Za-z ]/g,'');
    v=v.toUpperCase();
    v=v.replace(/\s+/g,' ');

    document.getElementById(id).value=v;
}

document.getElementById("name").oninput=function(){
    cleanText("name");
}


function checkIBAN(){

    let iban=document.getElementById("iban").value.trim();

    if(iban.length<15){
        alert("Invalid IBAN");
        return;
    }

    fetch("https://openiban.com/validate/"+iban+"?getBIC=true&validateBankCode=true")
    .then(r=>r.json())
    .then(d=>{

        if(d.valid){

            document.getElementById("swift").value=d.bankData.bic || "";

            document.getElementById("bank").value=d.bankData.name || "";
            document.getElementById("city").value=d.bankData.city || "";
            document.getElementById("country").value=d.countryCode || "";

        }else{
            alert("Invalid IBAN");
        }

    })
    .catch(()=>{
        alert("Connection Error");
    });

}



function checkSWIFT(){

    let swift=document.getElementById("swift").value.trim();

    if(swift.length<8){
        alert("Invalid SWIFT");
        return;
    }

    fetch("https://bank.codes/api/v1/swift/"+swift)
    .then(r=>r.json())
    .then(d=>{

        if(d.success){

            document.getElementById("bank").value=d.data.bank || "";
            document.getElementById("city").value=d.data.city || "";
            document.getElementById("country").value=d.data.country || "";

        }else{
            alert("Invalid SWIFT");
        }

    })
    .catch(()=>{
        alert("Connection Error");
    });

}



function saveData(){

    let data={
        name:document.getElementById("name").value,
        iban:document.getElementById("iban").value,
        swift:document.getElementById("swift").value,
        bank:document.getElementById("bank").value,
        city:document.getElementById("city").value,
        country:document.getElementById("country").value,
        address:document.getElementById("address").value
    };

    localStorage.setItem("beneficiary",JSON.stringify(data));

    document.getElementById("status").innerHTML="Saved Successfully ✔️";

}

</script>

</body>
</html>
